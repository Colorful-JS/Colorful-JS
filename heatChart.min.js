(function(a,b,c){function g(b,c){this.element=b;this.options=a.extend({},e,c);this.methods=f;this._defaults=e;this._name=d;this.init()}var d="heatChart",e={dataTag:"td",applyTo:"background",theta:220,offset:0,saturation:70,lightness:50,alpha:1,reverse:false,blackAndWhite:false,discrete:false,steps:10,colorModel:"hsla",scale:"linear"};var f={get_number_from_html:function(b){return parseFloat(a(b).html())},hslToRgb:function(a,b,c){var d,e,g;a/=360;b/=100;c/=100;if(b==0){d=e=g=c}else{var h=c<.5?c*(1+b):c+b-c*b;var i=2*c-h;d=f.hue2rgb(i,h,a+1/3);e=f.hue2rgb(i,h,a);g=f.hue2rgb(i,h,a-1/3)}return[d*255,e*255,g*255]},hue2rgb:function(a,b,c){if(c<0)c+=1;if(c>1)c-=1;if(c<1/6)return a+(b-a)*6*c;if(c<1/2)return b;if(c<2/3)return a+(b-a)*(2/3-c)*6;return a}};g.prototype.init=function(){this.max=0;this.min=Infinity;this.values=new Array;if(this.options.discrete&&this.options.colorModel!="grayscale"){var b=this.options.theta/(this.options.steps-1);this.possible_hues=new Array;this.possible_hues.push(0);for(j=1;j<this.options.steps-1;j++){this.possible_hues.push(b*j)}this.possible_hues.push(this.options.theta)}this.children=a(this.element).find(this.options.dataTag);for(i=0;i<this.children.length;i++){var c=this.methods.get_number_from_html(this.children[i]);if(!isNaN(c)){this.values.push({element:this.children[i],value:c,scaled_val:null});if(c>this.max){this.max=c}if(c<this.min){this.min=c}}}for(i=0;i<this.values.length;i++){var d=this.values[i].value;var e=this.values[i].element;if(this.options.scale=="linear"){var f=(d-this.min)/(this.max-this.min)}else if(this.options.scale=="log"){var g,h,k;g=d==0?0:Math.log(d);h=this.min==0?0:Math.log(this.min);k=this.max==0?0:Math.log(this.max);var f=(g-h)/(k-h)}f=this.options.reverse?1-f:f;var l=(f*this.options.theta+this.options.offset)%360;var m=this.options.colorModel=="grayscale"?0:this.options.saturation;var n=this.options.lightness;if(this.options.discrete&&this.options.colorModel!="grayscale"){var o=Math.floor(f/(1/this.options.steps));if(o==this.options.steps){o--}l=(this.possible_hues[o]+this.options.offset)%360}if(this.options.colorModel=="rgb"||this.options.colorModel=="grayscale"){if(this.options.colorModel=="grayscale"){if(this.options.discrete){var p=1/this.options.steps;var q=Math.floor(f/p);if(q==this.options.steps){q--}var r=p*q;var s=Math.round(r*255)}else{var s=Math.round(f*255)}var t=[s,s,s]}else{var t=this.methods.hslToRgb(l,m,n)}a(e).css(this.options.applyTo,"rgb("+Math.round(t[0])+", "+Math.round(t[1])+", "+Math.round(t[2])+")")}else if(this.options.colorModel=="hsla"){a(e).css(this.options.applyTo,"hsla("+l+", "+m+"%, "+n+"%, "+this.options.alpha+")")}}};a.fn[d]=function(b){return this.each(function(){if(!a.data(this,"plugin_"+d)){a.data(this,"plugin_"+d,new g(this,b))}})}})(jQuery,window,document)